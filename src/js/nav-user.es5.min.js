"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createAvatar=exports.createNav=void 0;var _createClass=function(){function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}}(),_axios=require("axios"),_axios2=_interopRequireDefault(_axios),_senseJumpLogin=require("sense-jump-login"),_senseJumpLogin2=_interopRequireDefault(_senseJumpLogin),_defalt_avatar=require("../image/defalt_avatar.png"),_defalt_avatar2=_interopRequireDefault(_defalt_avatar),_open=require("../image/open.svg"),_open2=_interopRequireDefault(_open),_datacenter=require("../image/datacenter.svg"),_datacenter2=_interopRequireDefault(_datacenter),_evalution=require("../image/evalution.svg"),_evalution2=_interopRequireDefault(_evalution),_inference=require("../image/inference.svg"),_inference2=_interopRequireDefault(_inference),_mark=require("../image/mark.svg"),_mark2=_interopRequireDefault(_mark),_panorama=require("../image/panorama.svg"),_panorama2=_interopRequireDefault(_panorama),_resource=require("../image/resource.svg"),_resource2=_interopRequireDefault(_resource),_train=require("../image/train.svg"),_train2=_interopRequireDefault(_train),_user=require("../image/user.svg"),_user2=_interopRequireDefault(_user);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _asyncToGenerator(e){return function(){var s=e.apply(this,arguments);return new Promise(function(i,o){return function n(e,t){try{var r=s[e](t),a=r.value}catch(e){return void o(e)}if(!r.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});i(a)}("next")})}}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function fetchGet(e){return new Promise(function(n,t){_axios2.default.get(e).then(function(e){200===code?n(e.data.data):n(e)}).catch(function(e){(0,_senseJumpLogin2.default)(e),t(e)})})}var createNav=function(){function n(e){_classCallCheck(this,n),this.navList=null,this.DOM=e}var e;return _createClass(n,[{key:"getNavList",value:(e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetchGet("/uums/navbars");case 2:return this.navList=e.sent,e.abrupt("return",this.navList);case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"init",value:function(){var r=this;this.getNavList().then(function(e){r.addStyle();var n='\n      <div class="nav-content">\n        <div id="dropBtn" class="drop-btn">\n          <img src="'+_open2.default+'"/>\n          <span>系统导航</span>\n        </div>\n        <ol id="navDropMenu" class="nav-drop-menu">';e.forEach(function(e){n+='\n          <li>\n            <a href="'+(e.url||"#")+'" target="_blank">\n              <img src="'+(e.key||"#")+'"/>\n              <span>'+(e.name||"-")+"</span>\n            </a>\n          </li>\n          "}),n+="</ol></div>",r.DOM.innerHTML=n;var e=document.getElementById("dropBtn"),t=document.getElementById("navDropMenu");e.onclick=function(){"visible"===t.style.visibility?(t.style.visibility="hidden",t.style.opacity=0):(t.style.opacity=1,t.style.visibility="visible")}})}},{key:"addStyle",value:function(){var e=document.createElement("style");e.type="text/css",e.innerHTML+='\n    .nav-content{ position: relative; color: #fff; }\n    .nav-content>.drop-btn{\n      cursor: pointer;\n      padding: 18px 20px;\n    }\n    .nav-content>.nav-drop-menu{\n      background: #16223B;\n      margin: 0;\n      padding: 10px 0 0 10px;\n      max-width: 600px;\n      border-top: 1px solid #fff;\n      list-style: none;\n      visibility: hidden;\n      opacity: 0;\n      transition: all .5s ease-out;\n    }\n    .nav-content>.nav-drop-menu::after {\n      content: "";\n      display: block;\n      height: 0;\n      clear: both;\n      visibility: hidden;\n      overflow: hidden;\n    }\n    .nav-content>.nav-drop-menu>li{\n      width: 140px;\n      height: 45px;\n      background: rgba(255, 255, 255, 0.04);\n      border-radius: 2px;\n      margin-right: 10px;\n      margin-bottom: 10px;\n      float: left;\n    }\n    .nav-content>.nav-drop-menu>li:hover,\n    .nav-content>.nav-drop-menu>li.active{\n      border-left: 3px solid #0FD0F2;\n    }\n    .nav-content>.nav-drop-menu>li>a>img{\n      vertical-align: sub;\n    }\n    .nav-content a {\n      text-decoration:none;\n      color: #fff;\n      display: inline-block;\n      width: 100%;\n      height: 100%;\n      text-align: center;\n      line-height: 3;\n    }\n    ',document.getElementsByTagName("head")[0].appendChild(e)}}]),n}(),createAvatar=function(){function n(e){_classCallCheck(this,n),this.userinfo=null,this.DOM=e}var e;return _createClass(n,[{key:"getUserInfo",value:(e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetchGet("/uums/user_info");case 2:return this.userinfo=e.sent,e.abrupt("return",this.userinfo);case 4:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"init",value:function(){var t=this;this.getUserInfo().then(function(e){t.addStyle();e='\n      <div class="user-info">\n        <div id="avatarContent" class="avatar">\n          <img src="'+_defalt_avatar2.default+'" alt="默认头像" />\n          <span class="detail">\n            <div class="name">'+(e.name||"-")+'</div>\n            <div class="role">'+(e.role&&e.role.name?e.role.name:"-")+'</div>\n          </span>\n        </div>\n        <ol id="dropMenu" class="drop-menu">\n          <li><a href="'+e.profileUrl+'" target="_blank">个人主页</a></li>\n          <li><a href="'+e.logoutUrl+'">退出</a></li>\n        </ol>\n      </div>';t.DOM.innerHTML=e;var e=document.getElementById("avatarContent"),n=document.getElementById("dropMenu");n.onmouseover=e.onmouseover=function(){n.style.visibility="visible",n.style.opacity=1},n.onmouseout=e.onmouseout=function(){n.style.visibility="hidden",n.style.opacity=0}})}},{key:"addStyle",value:function(){var e=document.createElement("style");e.type="text/css",e.innerHTML+="\n    .user-info{ position: relative; }\n    .user-info>.avatar {\n      cursor: pointer;\n      width: 110px;\n      display: flex;\n      justify-content: space-between;\n      color: #fff;\n    }\n    .user-info>.avatar>img{ width:35px; }\n    .user-info>.drop-menu {\n      list-style: none;\n      background: #16223B;\n      position: absolute;\n      top: 36px;\n      left: 10px;\n      margin: 0;\n      padding: 0;\n      border-radius: 3px;\n      visibility: hidden;\n      opacity: 0;\n      transition: all .5s ease-out;\n    }\n    .user-info>.drop-menu>li{\n      padding: 5px 10px;\n    }\n    .user-info a {\n      text-decoration:none;\n      color: hsla(0,0%,100%,.6);\n    }\n    .user-info a:hover {\n      color: hsla(0,0%,100%,1);\n    }\n    ",document.getElementsByTagName("head")[0].appendChild(e)}}]),n}();exports.createNav=createNav,exports.createAvatar=createAvatar;